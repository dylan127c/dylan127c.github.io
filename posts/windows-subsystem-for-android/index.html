<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Windows Subsystem for Android | Think</title>
<meta name="keywords" content="Windows Subsystem, Virtual Machine, Android">
<meta name="description" content="概述 Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署">
<meta name="author" content="dylan">
<link rel="canonical" href="https://dylan127c.github.io/posts/windows-subsystem-for-android/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.9f7d3dc9240f18907d50a19dfc8749665712c31a82ae69870cdc8ab4858917ed.css" integrity="sha256-n309ySQPGJB9UKGd/IdJZlcSwxqCrmmHDNyKtIWJF&#43;0=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://dylan127c.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://dylan127c.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://dylan127c.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://dylan127c.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://dylan127c.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="/css/lightgallery.min.css">



<script src="/js/mermaid.min.js"></script>
<script>
    
    const config = {
        startOnLoad: true,
        theme: 'forest',
        themeVariables: {
            lineColor: "#ff8033" 
        },
        flowchart: {
            useMaxWidth: false,
            htmlLabels: true
        }
    };
    
    mermaid.initialize(config);
    
    
    window.onload = () => {
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    }
</script><meta property="og:title" content="Windows Subsystem for Android" />
<meta property="og:description" content="概述 Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dylan127c.github.io/posts/windows-subsystem-for-android/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-04-15T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Windows Subsystem for Android"/>
<meta name="twitter:description" content="概述 Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://dylan127c.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Windows Subsystem for Android",
      "item": "https://dylan127c.github.io/posts/windows-subsystem-for-android/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Windows Subsystem for Android",
  "name": "Windows Subsystem for Android",
  "description": "概述 Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署",
  "keywords": [
    "Windows Subsystem", "Virtual Machine", "Android"
  ],
  "articleBody": "概述 Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署在 Windows 系统上。\n虚拟化技术 WSA 依赖于虚拟化技术，需要在 Windows 功能中启用 Hyper-V 功能和虚拟机平台功能，请参考：虚拟化技术。\n安装 WSA 一般可以可以通过 Microsoft Store 获取并安装 WSA，但国区应用商店内尚未上架。即便如此，仍旧可以使用某些方法，将 WSA 安装到 Windows 系统上。\n方法有两种：\n修改 Windows 系统的国家或地区，将其修改为支持安装 WSA 的特定区域； 获取 WSA 离线安装包，通过 Windows PowerShell 将其安装到 Windows 系统上。 个人比较推荐使用第二种方法。\n方法一：修改地域 在 Windows 设置中找到国家或地区选项，将“中国”修改为“美国”（或其它支持安装 WSA 安卓子系统应用的区域）：\n修改完毕后打开 Microsoft Store 应用商店，它将自动定位到美区的应用市场上。\n搜索 Amazon Appstore 应用下载并安装：\nAmazon Appstore 应用安装完毕后，WSA 也将一并安装到 Windows 系统中。\n这种方法虽然简单，但无人知道微软是否打算在未来对应用商店的进行区域封锁。如果未来存在区域封锁，可以选择使用第二种安装方法。\n方法二：命令行安装 命令行安装只需要下载 WSA 的安装包，利用几条简短的命令即可完成。从流程上看，它甚至没有修改地域来得麻烦。\n访问 Microsoft Store - Generation Project 搜索 WSA 的 ProductId 产品编码：\n9P3395VX91NR 其中，列表末尾的 .msixbundle 类型文件就是 WSA 的安装包，下载到本地任意目录。\n进入安装包所在目录，以管理员身份打开 Windows PowerShell 终端并执行命令：\nAdd-AppxPackage .\\MicrosoftCorporationII.WindowsSubsystemForAndroid_2206.40000.15.0_neutral___8wekyb3d8bbwe.Msixbundle 等待安装进度条结束，WSA 安装即完成。\n在 Windows 11 系统下，唤醒开始菜单，能够在全部应用列表中，查看到适用于 Android™️ 的 Windows 子系统设置：\n这就意味着 WSA 已经成功安装到 Windows 系统中。\nAndroid 应用安装 以上无论采取何种方法安装 WSA，程序都会将 Amazon Appstore 应用部署到 Windows 系统下，因为它是 WSA 默认的应用商店。\n同样受限于国区网络原因，Amazon Appstore 实际无法使用。\n但实际上 WSA 就是某种意义上的安卓系统，可以通过命令行的方式将 Android 应用安装到 WSA 中，使用\nAndroid 调试桥（Android Debug Bridge, adb）工具即可。\nAndroid 调试桥 ADB 工具在 Windows 系统下，是一个简单的 abd.exe 可执行程序，它仅能够在终端中以命令行的形式调用。\nADB 工具可从 Platform Tools 网站获取，选择“适用于 Windows 的 SDK Platform-Tools”下载：\n下载并解压到固定目录（便于配置全局环境变量）：\n随后将 abd.exe 所在目录，添加到系统变量下的 Path 中：\n完成后，在任何位置唤醒终端，都能够直接使用 adb 工具。\n启用开发者模式 ADB 工具实则用于调试 Android 系统，启用调试首先需要与 Android 系统建立连接。Android 系统如果需要接受调试，则必须启用开发人员模式（开发者模式）。\n打开 WSA 子系统，在开发人员选项卡中启用开发人员模式：\n首次启用开发人员模式时，WSA 内的调试模式可能仍尚未启用，使用 ADB 工具连接 WSA 可能会提示连接失败。建议启用开发人员模式后重启子系统，或进入管理开发人员设置手动激活开发人员模式。\n连接/断开 Android 系统 连接 Android 系统：\nadb connect 127.0.0.1:58526 断开 Android 系统：\nadb disconnect 127.0.0.1:58526 使用 ADB 安装应用 ADB 工具安装应用十分简单，与 WSA 建立连接后，使用以下命令即可安装任意的 Android 应用：\nadb install {android package path} 以 Apple Music 应用为例，假如已经获取了 Apple Music.apk 安装包，那么执行以下命令即可完成安装：\n在 Windows 11 系统下，能够在全部应用中找到已安装的 Android 应用入口：\n卸载 Android 应用与卸载 UWP 应用的操作一样，在应用图标的右键菜单中选择卸载，可移除指定的应用。\n更多设置 WSA（2206.40000.15.0）默认采用的子系统资源策略是连续模式，该模式下子系统始终在后台运行，以此加快 WSA 应用的启动速度。\n简单来说，子系统资源中如果选择了连续模式，就等同于选择了让 WSA 随开机一起自启动。\n如果非频繁使用 WSA 应用，还可以选择使用按需要模式。\n最新版本（2303.40000.4.0）的 WSA 中还提供了部分运行中模式：\n现存问题 WSA 安装子系统在使用的过程中，可能会弹出以下连接受限通知：\n但实际 VirtWifi 并未受限，换句话说 WSA 内的网络访问实际没有问题。\n可以使用 ABD 调试工具，以命令行的方式间接关闭 WSA 的连接受限通知：\nadb shell settings put global captive_portal_https_url https://www.google.cn/generate_204 adb shell settings put global captive_portal_http_url http://www.google.cn/generate_204 其中 captiv_protal_http_url 是 VirtWifi 用于测试网络连通性的目标网址。\n以上命令用于更改这个目标网址为安卓中国的测试链接：http://www.google.cn/generate_204。\n显然，受限通知的出现，是因为 WSA 内使用了某个国内网络无法访问的网址，作为 VirtWifi 连通性测试的目标网址。这样即便 VirtWifi 网络正常（国内网络可用），网络连通性测试也大概率会失败告终。\n反馈到 Windows 系统中，就会提示连接受限（某种意义上确实受限）。\n重新配置了 captiv_protal_http_url 后，可以通过以下命令行查看配置是否生效：\nadb shell settings get global captive_portal_https_url adb shell settings get global captive_portal_http_url 想了解更多有关 WSA 的详情，请参考：适用于 Android™️ 的 Windows 子系统。\n",
  "wordCount" : "1850",
  "inLanguage": "en",
  "datePublished": "2022-08-12T00:00:00Z",
  "dateModified": "2023-04-15T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "dylan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dylan127c.github.io/posts/windows-subsystem-for-android/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Think",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dylan127c.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://dylan127c.github.io/" accesskey="h" title="Think (Alt + H)">Think</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://dylan127c.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://dylan127c.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://dylan127c.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://dylan127c.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://dylan127c.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://dylan127c.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Windows Subsystem for Android
    </h1>
    <div class="post-meta">
<span class='changeTitle' title='2022-08-12 00:00:00 +0000 UTC'><i class='fa fa-calendar'></i>&nbsp;Aug 12, 2022</span>&nbsp;·&nbsp;<span class='changeTitle' title='2023-04-15 00:00:00 +0000 UTC'><i class='fa fa-calendar-check-o'></i>&nbsp;Apr 15, 2023</span>&nbsp;·&nbsp;<span title='Words_Count'><i class='fa fa-pencil-square-o'></i>&nbsp;1850 words</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="概述">概述</a></li>
                <li>
                    <a href="#%e8%99%9a%e6%8b%9f%e5%8c%96%e6%8a%80%e6%9c%af" aria-label="虚拟化技术">虚拟化技术</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-wsa" aria-label="安装 WSA">安装 WSA</a><ul>
                        
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%b8%80%e4%bf%ae%e6%94%b9%e5%9c%b0%e5%9f%9f" aria-label="方法一：修改地域">方法一：修改地域</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%ba%8c%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%ae%89%e8%a3%85" aria-label="方法二：命令行安装">方法二：命令行安装</a></li></ul>
                </li>
                <li>
                    <a href="#android-%e5%ba%94%e7%94%a8%e5%ae%89%e8%a3%85" aria-label="Android 应用安装">Android 应用安装</a><ul>
                        
                <li>
                    <a href="#android-%e8%b0%83%e8%af%95%e6%a1%a5" aria-label="Android 调试桥">Android 调试桥</a></li>
                <li>
                    <a href="#%e5%90%af%e7%94%a8%e5%bc%80%e5%8f%91%e8%80%85%e6%a8%a1%e5%bc%8f" aria-label="启用开发者模式">启用开发者模式</a></li>
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5%e6%96%ad%e5%bc%80-android-%e7%b3%bb%e7%bb%9f" aria-label="连接/断开 Android 系统">连接/断开 Android 系统</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8-adb-%e5%ae%89%e8%a3%85%e5%ba%94%e7%94%a8" aria-label="使用 ADB 安装应用">使用 ADB 安装应用</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%9b%b4%e5%a4%9a%e8%ae%be%e7%bd%ae" aria-label="更多设置">更多设置</a></li>
                <li>
                    <a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98" aria-label="现存问题">现存问题</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="概述">概述<a hidden class="anchor" aria-hidden="true" href="#概述">#</a></h3>
<p>Windows Subsystem for Android（WSA）全称适用于 Android™️ 的 Windows 子系统。顾名思义，它是微软在 Windows 系统上推出的 Android 子系统，它允许将 Android 应用间接部署在 Windows 系统上。</p>
<h3 id="虚拟化技术">虚拟化技术<a hidden class="anchor" aria-hidden="true" href="#虚拟化技术">#</a></h3>
<p>WSA 依赖于虚拟化技术，需要在 Windows 功能中启用 Hyper-V 功能和虚拟机平台功能，请参考：<a href="../hyper-v-easy-gpu-pv/#%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF">虚拟化技术</a>。</p>
<h3 id="安装-wsa">安装 WSA<a hidden class="anchor" aria-hidden="true" href="#安装-wsa">#</a></h3>
<p>一般可以可以通过 Microsoft Store 获取并安装 WSA，但国区应用商店内尚未上架。即便如此，仍旧可以使用某些方法，将 WSA 安装到 Windows 系统上。</p>
<p>方法有两种：</p>
<ol>
<li>修改 Windows 系统的国家或地区，将其修改为支持安装 WSA 的特定区域；</li>
<li>获取 WSA 离线安装包，通过 Windows PowerShell 将其安装到 Windows 系统上。</li>
</ol>
<p>个人比较推荐使用第二种方法。</p>
<h4 id="方法一修改地域">方法一：修改地域<a hidden class="anchor" aria-hidden="true" href="#方法一修改地域">#</a></h4>
<p>在 Windows 设置中找到<strong>国家或地区</strong>选项，将“中国”修改为“美国”（或其它支持安装 WSA 安卓子系统应用的区域）：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/Snipaste_2022-08-12_15-04-53.png#center" alt="Snipaste_2022-08-12_15-04-53"  />
</p>
<p>修改完毕后打开 Microsoft Store 应用商店，它将自动定位到美区的应用市场上。</p>
<p>搜索 Amazon Appstore 应用下载并安装：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/Snipaste_2022-08-12_15-07-50.png#center" alt="Snipaste_2022-08-12_15-07-50"  />
</p>
<p><strong>Amazon Appstore 应用安装完毕后，WSA 也将一并安装到 Windows 系统中。</strong></p>
<p>这种方法虽然简单，但无人知道微软是否打算在未来对应用商店的进行区域封锁。如果未来存在区域封锁，可以选择使用第二种安装方法。</p>
<h4 id="方法二命令行安装">方法二：命令行安装<a hidden class="anchor" aria-hidden="true" href="#方法二命令行安装">#</a></h4>
<p>命令行安装只需要下载 WSA 的安装包，利用几条简短的命令即可完成。从流程上看，它甚至没有修改地域来得麻烦。</p>
<p>访问 <a href="https://store.rg-adguard.net">Microsoft Store - Generation Project</a> 搜索 WSA 的 <strong>ProductId</strong> 产品编码：</p>
<pre tabindex="0"><code>9P3395VX91NR
</code></pre><p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812151825728.png#center" alt="image-20220812151825728"  />
</p>
<p>其中，列表末尾的 .msixbundle 类型文件就是 WSA 的安装包，下载到本地任意目录。</p>
<p>进入安装包所在目录，以管理员身份打开 Windows PowerShell 终端并执行命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Add-AppxPackage .\MicrosoftCorporationII.WindowsSubsystemForAndroid_2206.40000.15.0_neutral___8wekyb3d8bbwe.Msixbundle
</span></span></code></pre></div><p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/Snipaste_2022-08-12_15-34-00.png#center" alt="Snipaste_2022-08-12_15-34-00"  />
</p>
<p>等待安装进度条结束，WSA 安装即完成。</p>
<p>在 Windows 11 系统下，唤醒开始菜单，能够在全部应用列表中，查看到适用于 Android™️ 的 Windows 子系统设置：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812153906724.png#center" alt="image-20220812153906724"  />
</p>
<p>这就意味着 WSA 已经成功安装到 Windows 系统中。</p>
<h3 id="android-应用安装">Android 应用安装<a hidden class="anchor" aria-hidden="true" href="#android-应用安装">#</a></h3>
<p>以上无论采取何种方法安装 WSA，程序都会将 Amazon Appstore 应用部署到 Windows 系统下，因为它是 WSA 默认的应用商店。</p>
<p>同样受限于国区网络原因，Amazon Appstore 实际无法使用。</p>
<p>但实际上 WSA 就是某种意义上的安卓系统，可以通过命令行的方式将 Android 应用安装到 WSA 中，使用</p>
<p><a href="https://developer.android.com/studio/command-line/adb">Android 调试桥</a>（Android Debug Bridge, adb）工具即可。</p>
<h4 id="android-调试桥">Android 调试桥<a hidden class="anchor" aria-hidden="true" href="#android-调试桥">#</a></h4>
<p>ADB 工具在 Windows 系统下，是一个简单的 abd.exe 可执行程序，它仅能够在终端中以命令行的形式调用。</p>
<p>ADB 工具可从 <a href="https://developer.android.com/studio/releases/platform-tools">Platform Tools</a> 网站获取，选择“<strong>适用于 Windows 的 SDK Platform-Tools</strong>”下载：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812163031217.png#center" alt="image-20220812163031217"  />
</p>
<p>下载并解压到固定目录（便于配置全局环境变量）：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812160002367.png#center" alt="image-20220812160002367"  />
</p>
<p>随后将 abd.exe 所在目录，添加到<strong>系统变量</strong>下的 Path 中：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812163246253.png#center" alt="image-20220812163246253"  />
</p>
<p>完成后，在任何位置唤醒终端，都能够直接使用 adb 工具。</p>
<h4 id="启用开发者模式">启用开发者模式<a hidden class="anchor" aria-hidden="true" href="#启用开发者模式">#</a></h4>
<p>ADB 工具实则用于调试 Android 系统，启用调试首先需要与 Android 系统建立连接。Android 系统如果需要接受调试，则必须启用<strong>开发人员模式</strong>（开发者模式）。</p>
<p>打开 WSA 子系统，在开发人员选项卡中启用开发人员模式：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812160152216.png#center" alt="image-20220812160152216"  />
</p>
<p>首次启用开发人员模式时，WSA 内的调试模式可能仍尚未启用，使用 ADB 工具连接 WSA 可能会提示连接失败。建议启用开发人员模式后<strong>重启子系统</strong>，或进入<strong>管理开发人员设置</strong>手动<strong>激活开发人员模式</strong>。</p>
<h4 id="连接断开-android-系统">连接/断开 Android 系统<a hidden class="anchor" aria-hidden="true" href="#连接断开-android-系统">#</a></h4>
<p>连接 Android 系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>adb connect 127.0.0.1<span style="color:#960050;background-color:#1e0010">:</span>58526
</span></span></code></pre></div><p>断开 Android 系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>adb disconnect 127.0.0.1<span style="color:#960050;background-color:#1e0010">:</span>58526
</span></span></code></pre></div><p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812160804526.png#center" alt="image-20220812160804526"  />
</p>
<h4 id="使用-adb-安装应用">使用 ADB 安装应用<a hidden class="anchor" aria-hidden="true" href="#使用-adb-安装应用">#</a></h4>
<p>ADB 工具安装应用十分简单，与 WSA 建立连接后，使用以下命令即可安装任意的 Android 应用：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>adb install {android package path}
</span></span></code></pre></div><p>以 Apple Music 应用为例，假如已经获取了 Apple Music.apk 安装包，那么执行以下命令即可完成安装：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812161146589.png#center" alt="image-20220812161146589"  />
</p>
<p>在 Windows 11 系统下，能够在全部应用中找到已安装的 Android 应用入口：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812161242068.png#center" alt="image-20220812161242068"  />
</p>
<p>卸载 Android 应用与卸载 UWP 应用的操作一样，在应用图标的右键菜单中选择卸载，可移除指定的应用。</p>
<h3 id="更多设置">更多设置<a hidden class="anchor" aria-hidden="true" href="#更多设置">#</a></h3>
<p>WSA（2206.40000.15.0）默认采用的<strong>子系统资源</strong>策略是<strong>连续</strong>模式，该模式下子系统始终在后台运行，以此加快 WSA 应用的启动速度。</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20230414193447540.png#center" alt="image-20230414193447540"  />
</p>
<p>简单来说，子系统资源中如果选择了连续模式，就等同于选择了让 WSA 随开机一起自启动。</p>
<p>如果非频繁使用 WSA 应用，还可以选择使用<strong>按需要</strong>模式。</p>
<p>最新版本（2303.40000.4.0）的 WSA 中还提供了<strong>部分运行中</strong>模式：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20230421193537358.png#center" alt="image-20230421193537358"  />
</p>
<h3 id="现存问题">现存问题<a hidden class="anchor" aria-hidden="true" href="#现存问题">#</a></h3>
<p>WSA 安装子系统在使用的过程中，可能会弹出以下连接受限通知：</p>
<p><img loading="lazy" src="../images/Windows%20Subsystem%20for%20Android.images/image-20220812165347271.png#center" alt="image-20220812165347271"  />
</p>
<p>但实际 VirtWifi 并未受限，换句话说 WSA 内的网络访问实际没有问题。</p>
<p>可以使用 ABD 调试工具，以命令行的方式间接关闭 WSA 的连接受限通知：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adb shell settings put global captive_portal_https_url https://www.google.cn/generate_204
</span></span><span style="display:flex;"><span>adb shell settings put global captive_portal_http_url http://www.google.cn/generate_204
</span></span></code></pre></div><p>其中 captiv_protal_http_url 是 VirtWifi 用于测试网络连通性的目标网址。</p>
<p>以上命令用于更改这个目标网址为安卓中国的测试链接：http://www.google.cn/generate_204。</p>
<p>显然，受限通知的出现，是因为 WSA 内使用了某个国内网络无法访问的网址，作为 VirtWifi 连通性测试的目标网址。这样即便 VirtWifi 网络正常（国内网络可用），网络连通性测试也大概率会失败告终。</p>
<p>反馈到 Windows 系统中，就会提示连接受限（某种意义上确实受限）。</p>
<p>重新配置了 captiv_protal_http_url 后，可以通过以下命令行查看配置是否生效：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> adb shell settings get global captive_portal_https_url
</span></span><span style="display:flex;"><span> adb shell settings get global captive_portal_http_url
</span></span></code></pre></div><p>想了解更多有关 WSA 的详情，请参考：<a href="https://learn.microsoft.com/zh-cn/windows/android/wsa/">适用于 Android™️ 的 Windows 子系统</a>。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://dylan127c.github.io/tags/windows-subsystem/">Windows Subsystem</a></li>
      <li><a href="https://dylan127c.github.io/tags/virtual-machine/">Virtual Machine</a></li>
      <li><a href="https://dylan127c.github.io/tags/android/">Android</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://dylan127c.github.io/posts/openssh-config/">
    <span class="title">« Prev</span>
    <br>
    <span>OpenSSH Config</span>
  </a>
  <a class="next" href="https://dylan127c.github.io/posts/hyper-v-easy-gpu-pv/">
    <span class="title">Next »</span>
    <br>
    <span>Hyper-V &amp; Easy-GPU-PV</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://dylan127c.github.io/">Think</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script type="text/javascript" src="/js/lightgallery.min.js"></script>
<script type="text/javascript" src="/js/lg-zoom.min.js"></script>
<script type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
<script src="https://kit.fontawesome.com/4895b8a1ce.js" crossorigin="anonymous"></script>

<script>

    
    var imgElements = document.querySelectorAll(".post-content p>img");
    if (imgElements.length > 0) {
        for (var i = 0; i < imgElements.length; i++) {
            var pElement = imgElements[i].parentNode;
            var aElement = document.createElement("a");

            aElement.setAttribute("href", imgElements[i].getAttribute("src"));
            aElement.setAttribute("class", "lightgallery");
            

            
            

            aElement.innerHTML = pElement.innerHTML;
            pElement.parentNode.replaceChild(aElement, pElement);
        }

        var postContent = document.getElementsByClassName("post-content")[0];
        postContent.setAttribute("id", "lightgallery");

        
        lightGallery(postContent, {
            
            speed: 500,
            counter: false,
            selector: ".lightgallery",
            hideBarsDelay: 2e3,
            toggleThumb: !0,
            thumbWidth: 80,
            thumbHeight: "60px",
            actualSize: !1,
            showZoomInOutIcons: !0
        });
    }

    
    var aLinkElement = document.querySelectorAll(".post-content p a")
    for (var i = 0; i < aLinkElement.length; i++) {
        aLinkElement[i].setAttribute("target", "_blank");
    }

    
    var changeData = ["DATE_CREATE", "DATE_MODIFY"];
    var changeTitles = document.querySelectorAll(".changeTitle");
    for (var i = 0; i < changeTitles.length; i++) {
        changeTitles[i].setAttribute("title", changeData[i]);
    }

</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
